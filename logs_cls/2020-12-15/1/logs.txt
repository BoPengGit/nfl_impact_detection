
-------------   Fold 1 / 5  -------------

Loaded pretrained weights for efficientnet-b3
    -> 154983 training images
    -> 38748 validation images
    -> 10702380 trainable parameters

Using 158 out of 1210 batches by limiting to 10 samples per player.

Epoch 01/20 	 lr=1.0e-03	 t=67s 	loss=0.633	val_loss=0.474 	 auc=0.800	 aucs_aux=[0.777, 0.82, 0.743]
Epoch 02/20 	 lr=9.5e-04	 t=66s 	loss=0.418	val_loss=0.437 	 auc=0.821	 aucs_aux=[0.818, 0.768, 0.865]
Epoch 03/20 	 lr=8.9e-04	 t=66s 	loss=0.411	val_loss=0.375 	 auc=0.844	 aucs_aux=[0.841, 0.799, 0.922]
Epoch 04/20 	 lr=8.4e-04	 t=66s 	loss=0.405	val_loss=0.394 	 auc=0.848	 aucs_aux=[0.85, 0.804, 0.859]
Epoch 05/20 	 lr=7.9e-04	 t=66s 	loss=0.397	val_loss=0.340 	 auc=0.860	 aucs_aux=[0.859, 0.82, 0.99]
Epoch 06/20 	 lr=7.4e-04	 t=66s 	loss=0.390	val_loss=0.356 	 auc=0.857	 aucs_aux=[0.86, 0.829, 0.958]
Epoch 07/20 	 lr=6.8e-04	 t=66s 	loss=0.380	val_loss=0.341 	 auc=0.861	 aucs_aux=[0.869, 0.818, 0.994]
Epoch 08/20 	 lr=6.3e-04	 t=66s 	loss=0.372	val_loss=0.335 	 auc=0.880	 aucs_aux=[0.886, 0.839, 0.937]
Epoch 09/20 	 lr=5.8e-04	 t=66s 	loss=0.378	val_loss=0.363 	 auc=0.869	 aucs_aux=[0.875, 0.824, 0.967]
Epoch 10/20 	 lr=5.3e-04	 t=66s 	loss=0.368	val_loss=0.346 	 auc=0.884	 aucs_aux=[0.886, 0.843, 0.996]
Epoch 11/20 	 lr=4.7e-04	 t=66s 	loss=0.366	val_loss=0.390 	 auc=0.860	 aucs_aux=[0.861, 0.825, 0.995]
Epoch 12/20 	 lr=4.2e-04	 t=66s 	loss=0.358	val_loss=0.322 	 auc=0.883	 aucs_aux=[0.89, 0.838, 0.998]
Epoch 13/20 	 lr=3.7e-04	 t=66s 	loss=0.345	val_loss=0.340 	 auc=0.875	 aucs_aux=[0.881, 0.835, 0.997]
Epoch 14/20 	 lr=3.2e-04	 t=66s 	loss=0.350	val_loss=0.339 	 auc=0.880	 aucs_aux=[0.891, 0.836, 0.996]
Epoch 15/20 	 lr=2.6e-04	 t=66s 	loss=0.334	val_loss=0.327 	 auc=0.892	 aucs_aux=[0.901, 0.839, 0.998]
Epoch 16/20 	 lr=2.1e-04	 t=66s 	loss=0.334	val_loss=0.317 	 auc=0.895	 aucs_aux=[0.905, 0.841, 0.997]
Epoch 17/20 	 lr=1.6e-04	 t=66s 	loss=0.328	val_loss=0.324 	 auc=0.895	 aucs_aux=[0.904, 0.84, 0.997]
Epoch 18/20 	 lr=1.1e-04	 t=66s 	loss=0.320	val_loss=0.325 	 auc=0.896	 aucs_aux=[0.905, 0.842, 0.997]
Epoch 19/20 	 lr=5.3e-05	 t=66s 	loss=0.316	val_loss=0.320 	 auc=0.897	 aucs_aux=[0.906, 0.842, 0.997]
Epoch 20/20 	 lr=0.0e+00	 t=66s 	loss=0.319	val_loss=0.320 	 auc=0.897	 aucs_aux=[0.907, 0.842, 0.998]

 -> Saving weights to ../logs_cls/2020-12-15/1/efficientnet-b3_0.pt


 - Predicting on full data.

-------------   Fold 2 / 5  -------------

Loaded pretrained weights for efficientnet-b3
    -> 155072 training images
    -> 38659 validation images
    -> 10702380 trainable parameters

Using 158 out of 1211 batches by limiting to 10 samples per player.

Epoch 01/20 	 lr=1.0e-03	 t=66s 	loss=0.635	val_loss=0.764 	 auc=0.738	 aucs_aux=[0.726, 0.753, 0.668]
Epoch 02/20 	 lr=9.5e-04	 t=66s 	loss=0.414	val_loss=0.409 	 auc=0.816	 aucs_aux=[0.816, 0.752, 0.601]
Epoch 03/20 	 lr=8.9e-04	 t=66s 	loss=0.395	val_loss=0.394 	 auc=0.827	 aucs_aux=[0.841, 0.755, 0.859]
Epoch 04/20 	 lr=8.4e-04	 t=66s 	loss=0.387	val_loss=0.359 	 auc=0.847	 aucs_aux=[0.851, 0.802, 0.954]
Epoch 05/20 	 lr=7.9e-04	 t=66s 	loss=0.385	val_loss=0.393 	 auc=0.845	 aucs_aux=[0.861, 0.781, 0.937]
Epoch 06/20 	 lr=7.4e-04	 t=66s 	loss=0.380	val_loss=0.355 	 auc=0.848	 aucs_aux=[0.855, 0.786, 0.977]
Epoch 07/20 	 lr=6.8e-04	 t=66s 	loss=0.372	val_loss=0.378 	 auc=0.831	 aucs_aux=[0.834, 0.794, 0.936]
Epoch 08/20 	 lr=6.3e-04	 t=66s 	loss=0.369	val_loss=0.370 	 auc=0.842	 aucs_aux=[0.851, 0.787, 0.951]
Epoch 09/20 	 lr=5.8e-04	 t=66s 	loss=0.367	val_loss=0.365 	 auc=0.842	 aucs_aux=[0.85, 0.792, 0.965]
Epoch 10/20 	 lr=5.3e-04	 t=66s 	loss=0.361	val_loss=0.353 	 auc=0.860	 aucs_aux=[0.868, 0.813, 0.98]
Epoch 11/20 	 lr=4.7e-04	 t=66s 	loss=0.357	val_loss=0.347 	 auc=0.863	 aucs_aux=[0.873, 0.812, 0.978]
Epoch 12/20 	 lr=4.2e-04	 t=66s 	loss=0.340	val_loss=0.353 	 auc=0.859	 aucs_aux=[0.866, 0.814, 0.99]
Epoch 13/20 	 lr=3.7e-04	 t=66s 	loss=0.341	val_loss=0.360 	 auc=0.859	 aucs_aux=[0.867, 0.811, 0.988]
Epoch 14/20 	 lr=3.2e-04	 t=66s 	loss=0.335	val_loss=0.362 	 auc=0.862	 aucs_aux=[0.866, 0.818, 0.99]
Epoch 15/20 	 lr=2.6e-04	 t=66s 	loss=0.337	val_loss=0.350 	 auc=0.872	 aucs_aux=[0.881, 0.816, 0.987]
Epoch 16/20 	 lr=2.1e-04	 t=66s 	loss=0.329	val_loss=0.348 	 auc=0.872	 aucs_aux=[0.88, 0.819, 0.986]
Epoch 17/20 	 lr=1.6e-04	 t=66s 	loss=0.321	val_loss=0.344 	 auc=0.874	 aucs_aux=[0.881, 0.821, 0.987]
Epoch 18/20 	 lr=1.1e-04	 t=66s 	loss=0.318	val_loss=0.347 	 auc=0.875	 aucs_aux=[0.881, 0.823, 0.988]
Epoch 19/20 	 lr=5.3e-05	 t=66s 	loss=0.313	val_loss=0.349 	 auc=0.876	 aucs_aux=[0.882, 0.824, 0.989]
Epoch 20/20 	 lr=0.0e+00	 t=66s 	loss=0.307	val_loss=0.353 	 auc=0.876	 aucs_aux=[0.882, 0.824, 0.989]

 -> Saving weights to ../logs_cls/2020-12-15/1/efficientnet-b3_1.pt


 - Predicting on full data.

-------------   Fold 3 / 5  -------------

Loaded pretrained weights for efficientnet-b3
    -> 154983 training images
    -> 38748 validation images
    -> 10702380 trainable parameters

Using 158 out of 1210 batches by limiting to 10 samples per player.

Epoch 01/20 	 lr=1.0e-03	 t=66s 	loss=0.635	val_loss=0.410 	 auc=0.796	 aucs_aux=[0.791, 0.765, 0.789]
Epoch 02/20 	 lr=9.5e-04	 t=66s 	loss=0.427	val_loss=0.401 	 auc=0.815	 aucs_aux=[0.81, 0.778, 0.871]
Epoch 03/20 	 lr=8.9e-04	 t=66s 	loss=0.414	val_loss=0.369 	 auc=0.830	 aucs_aux=[0.834, 0.734, 0.965]
Epoch 04/20 	 lr=8.4e-04	 t=66s 	loss=0.409	val_loss=0.392 	 auc=0.830	 aucs_aux=[0.838, 0.774, 0.9]
Epoch 05/20 	 lr=7.9e-04	 t=66s 	loss=0.394	val_loss=0.354 	 auc=0.836	 aucs_aux=[0.834, 0.809, 0.947]
Epoch 06/20 	 lr=7.4e-04	 t=66s 	loss=0.386	val_loss=0.346 	 auc=0.862	 aucs_aux=[0.872, 0.82, 0.949]
Epoch 07/20 	 lr=6.8e-04	 t=66s 	loss=0.380	val_loss=0.351 	 auc=0.857	 aucs_aux=[0.863, 0.803, 0.96]
Epoch 08/20 	 lr=6.3e-04	 t=66s 	loss=0.382	val_loss=0.363 	 auc=0.868	 aucs_aux=[0.874, 0.825, 0.968]
Epoch 09/20 	 lr=5.8e-04	 t=66s 	loss=0.375	val_loss=0.351 	 auc=0.872	 aucs_aux=[0.873, 0.839, 0.951]
Epoch 10/20 	 lr=5.3e-04	 t=66s 	loss=0.362	val_loss=0.368 	 auc=0.870	 aucs_aux=[0.872, 0.822, 0.978]
Epoch 11/20 	 lr=4.7e-04	 t=66s 	loss=0.359	val_loss=0.330 	 auc=0.875	 aucs_aux=[0.879, 0.835, 0.962]
Epoch 12/20 	 lr=4.2e-04	 t=66s 	loss=0.361	val_loss=0.329 	 auc=0.875	 aucs_aux=[0.876, 0.845, 0.981]
Epoch 13/20 	 lr=3.7e-04	 t=66s 	loss=0.354	val_loss=0.329 	 auc=0.881	 aucs_aux=[0.887, 0.836, 0.982]
Epoch 14/20 	 lr=3.2e-04	 t=66s 	loss=0.352	val_loss=0.325 	 auc=0.873	 aucs_aux=[0.878, 0.828, 0.982]
Epoch 15/20 	 lr=2.6e-04	 t=66s 	loss=0.344	val_loss=0.335 	 auc=0.876	 aucs_aux=[0.88, 0.837, 0.977]
Epoch 16/20 	 lr=2.1e-04	 t=66s 	loss=0.334	val_loss=0.335 	 auc=0.885	 aucs_aux=[0.889, 0.844, 0.981]
Epoch 17/20 	 lr=1.6e-04	 t=66s 	loss=0.329	val_loss=0.330 	 auc=0.887	 aucs_aux=[0.891, 0.843, 0.981]
Epoch 18/20 	 lr=1.1e-04	 t=66s 	loss=0.328	val_loss=0.328 	 auc=0.887	 aucs_aux=[0.891, 0.844, 0.981]
Epoch 19/20 	 lr=5.3e-05	 t=66s 	loss=0.322	val_loss=0.333 	 auc=0.888	 aucs_aux=[0.893, 0.843, 0.981]
Epoch 20/20 	 lr=0.0e+00	 t=66s 	loss=0.315	val_loss=0.333 	 auc=0.889	 aucs_aux=[0.894, 0.843, 0.983]

 -> Saving weights to ../logs_cls/2020-12-15/1/efficientnet-b3_2.pt


 - Predicting on full data.

-------------   Fold 4 / 5  -------------

Loaded pretrained weights for efficientnet-b3
    -> 154896 training images
    -> 38835 validation images
    -> 10702380 trainable parameters

Using 158 out of 1210 batches by limiting to 10 samples per player.

Epoch 01/20 	 lr=1.0e-03	 t=67s 	loss=0.638	val_loss=0.426 	 auc=0.793	 aucs_aux=[0.788, 0.77, 0.736]
Epoch 02/20 	 lr=9.5e-04	 t=66s 	loss=0.416	val_loss=0.383 	 auc=0.830	 aucs_aux=[0.834, 0.794, 0.815]
Epoch 03/20 	 lr=8.9e-04	 t=66s 	loss=0.400	val_loss=0.423 	 auc=0.835	 aucs_aux=[0.847, 0.79, 0.935]
Epoch 04/20 	 lr=8.4e-04	 t=66s 	loss=0.398	val_loss=0.384 	 auc=0.810	 aucs_aux=[0.823, 0.778, 0.954]
Epoch 05/20 	 lr=7.9e-04	 t=66s 	loss=0.392	val_loss=0.363 	 auc=0.850	 aucs_aux=[0.856, 0.816, 0.964]
Epoch 06/20 	 lr=7.4e-04	 t=66s 	loss=0.387	val_loss=0.362 	 auc=0.850	 aucs_aux=[0.862, 0.804, 0.962]
Epoch 07/20 	 lr=6.8e-04	 t=66s 	loss=0.374	val_loss=0.401 	 auc=0.838	 aucs_aux=[0.847, 0.81, 0.975]
Epoch 08/20 	 lr=6.3e-04	 t=66s 	loss=0.370	val_loss=0.361 	 auc=0.851	 aucs_aux=[0.86, 0.815, 0.963]
Epoch 09/20 	 lr=5.8e-04	 t=66s 	loss=0.364	val_loss=0.368 	 auc=0.849	 aucs_aux=[0.853, 0.82, 0.967]
Epoch 10/20 	 lr=5.3e-04	 t=66s 	loss=0.357	val_loss=0.354 	 auc=0.855	 aucs_aux=[0.863, 0.823, 0.95]
Epoch 11/20 	 lr=4.7e-04	 t=66s 	loss=0.360	val_loss=0.373 	 auc=0.856	 aucs_aux=[0.866, 0.821, 0.96]
Epoch 12/20 	 lr=4.2e-04	 t=66s 	loss=0.354	val_loss=0.344 	 auc=0.863	 aucs_aux=[0.869, 0.837, 0.974]
Epoch 13/20 	 lr=3.7e-04	 t=66s 	loss=0.349	val_loss=0.360 	 auc=0.860	 aucs_aux=[0.866, 0.829, 0.966]
Epoch 14/20 	 lr=3.2e-04	 t=66s 	loss=0.332	val_loss=0.390 	 auc=0.854	 aucs_aux=[0.86, 0.835, 0.958]
Epoch 15/20 	 lr=2.6e-04	 t=66s 	loss=0.332	val_loss=0.376 	 auc=0.862	 aucs_aux=[0.87, 0.828, 0.978]
Epoch 16/20 	 lr=2.1e-04	 t=66s 	loss=0.324	val_loss=0.359 	 auc=0.870	 aucs_aux=[0.879, 0.836, 0.973]
Epoch 17/20 	 lr=1.6e-04	 t=66s 	loss=0.319	val_loss=0.356 	 auc=0.871	 aucs_aux=[0.88, 0.837, 0.969]
Epoch 18/20 	 lr=1.1e-04	 t=66s 	loss=0.323	val_loss=0.358 	 auc=0.871	 aucs_aux=[0.879, 0.839, 0.968]
Epoch 19/20 	 lr=5.3e-05	 t=66s 	loss=0.317	val_loss=0.359 	 auc=0.872	 aucs_aux=[0.88, 0.84, 0.968]
Epoch 20/20 	 lr=0.0e+00	 t=66s 	loss=0.311	val_loss=0.359 	 auc=0.872	 aucs_aux=[0.881, 0.841, 0.967]

 -> Saving weights to ../logs_cls/2020-12-15/1/efficientnet-b3_3.pt


 - Predicting on full data.

-------------   Fold 5 / 5  -------------

Loaded pretrained weights for efficientnet-b3
    -> 154990 training images
    -> 38741 validation images
    -> 10702380 trainable parameters

Using 159 out of 1210 batches by limiting to 10 samples per player.

Epoch 01/20 	 lr=1.0e-03	 t=67s 	loss=0.636	val_loss=0.443 	 auc=0.811	 aucs_aux=[0.795, 0.809, 0.786]
Epoch 02/20 	 lr=9.5e-04	 t=66s 	loss=0.421	val_loss=0.387 	 auc=0.850	 aucs_aux=[0.852, 0.805, 0.909]
Epoch 03/20 	 lr=8.9e-04	 t=66s 	loss=0.406	val_loss=0.374 	 auc=0.842	 aucs_aux=[0.851, 0.816, 0.969]
Epoch 04/20 	 lr=8.4e-04	 t=66s 	loss=0.395	val_loss=0.374 	 auc=0.867	 aucs_aux=[0.871, 0.828, 0.98]
Epoch 05/20 	 lr=7.9e-04	 t=66s 	loss=0.383	val_loss=0.356 	 auc=0.860	 aucs_aux=[0.87, 0.83, 0.954]
Epoch 06/20 	 lr=7.4e-04	 t=66s 	loss=0.386	val_loss=0.354 	 auc=0.878	 aucs_aux=[0.883, 0.834, 0.946]
Epoch 07/20 	 lr=6.8e-04	 t=66s 	loss=0.373	val_loss=0.364 	 auc=0.881	 aucs_aux=[0.892, 0.837, 0.961]
Epoch 08/20 	 lr=6.3e-04	 t=66s 	loss=0.371	val_loss=0.353 	 auc=0.876	 aucs_aux=[0.895, 0.819, 0.888]
Epoch 09/20 	 lr=5.8e-04	 t=66s 	loss=0.361	val_loss=0.332 	 auc=0.882	 aucs_aux=[0.89, 0.837, 0.994]
Epoch 10/20 	 lr=5.3e-04	 t=66s 	loss=0.364	val_loss=0.356 	 auc=0.880	 aucs_aux=[0.887, 0.841, 0.993]
Epoch 11/20 	 lr=4.7e-04	 t=66s 	loss=0.362	val_loss=0.339 	 auc=0.879	 aucs_aux=[0.889, 0.841, 0.991]
Epoch 12/20 	 lr=4.2e-04	 t=66s 	loss=0.349	val_loss=0.339 	 auc=0.886	 aucs_aux=[0.894, 0.841, 0.991]
Epoch 13/20 	 lr=3.7e-04	 t=66s 	loss=0.354	val_loss=0.343 	 auc=0.883	 aucs_aux=[0.896, 0.837, 0.957]
Epoch 14/20 	 lr=3.2e-04	 t=66s 	loss=0.349	val_loss=0.344 	 auc=0.889	 aucs_aux=[0.901, 0.845, 0.967]
Epoch 15/20 	 lr=2.6e-04	 t=66s 	loss=0.338	val_loss=0.346 	 auc=0.895	 aucs_aux=[0.909, 0.851, 0.991]
Epoch 16/20 	 lr=2.1e-04	 t=66s 	loss=0.330	val_loss=0.331 	 auc=0.897	 aucs_aux=[0.911, 0.85, 0.991]
Epoch 17/20 	 lr=1.6e-04	 t=66s 	loss=0.322	val_loss=0.335 	 auc=0.898	 aucs_aux=[0.911, 0.853, 0.988]
Epoch 18/20 	 lr=1.1e-04	 t=66s 	loss=0.322	val_loss=0.330 	 auc=0.898	 aucs_aux=[0.911, 0.853, 0.991]
Epoch 19/20 	 lr=5.3e-05	 t=66s 	loss=0.318	val_loss=0.333 	 auc=0.898	 aucs_aux=[0.911, 0.852, 0.988]
Epoch 20/20 	 lr=0.0e+00	 t=66s 	loss=0.319	val_loss=0.335 	 auc=0.898	 aucs_aux=[0.911, 0.852, 0.987]

 -> Saving weights to ../logs_cls/2020-12-15/1/efficientnet-b3_4.pt


 - Predicting on full data.

  -> CV auc : 0.9000
